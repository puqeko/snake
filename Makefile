# File:   Makefile

# Author: Autogenerated

# Date:   2017-10-06

# Descr:  Makefile for game.c




# Definitions.

CC = avr-gcc

CFLAGS = -mmcu=atmega32u2 -Os -Wall -Wstrict-prototypes -Wextra -g -I./ -I../../drivers/ -I../../drivers/avr/ -I../../utils/

OBJCOPY = avr-objcopy

SIZE = avr-size

DEL = rm




# Default target.

all: game.out



# Compile: create object files from C source files.
game.o: ./game.c ./game_snake.h ./game_input.h ../../drivers/avr/timer.h ./game.h ../../utils/task.h ./game_display.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

task.o: ../../utils/task.c ../../utils/task.h ../../drivers/avr/system.h ../../drivers/avr/timer.h
	$(CC) -c $(CFLAGS) $< -o $@

timer.o: ../../drivers/avr/timer.c ../../drivers/avr/system.h ../../drivers/avr/timer.h
	$(CC) -c $(CFLAGS) $< -o $@

system.o: ../../drivers/avr/system.c ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

game_display.o: ./game_display.c ../../drivers/ledmat.h ./game_display.h ../../drivers/avr/pio.h ./game.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

ledmat.o: ../../drivers/ledmat.c ../../drivers/ledmat.h ../../drivers/avr/pio.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

pio.o: ../../drivers/avr/pio.c ../../drivers/avr/pio.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

game_snake.o: ./game_snake.c ./game.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

game_input.o: ./game_input.c ../../drivers/navswitch.h ./game.h ../../drivers/avr/system.h
	$(CC) -c $(CFLAGS) $< -o $@

navswitch.o: ../../drivers/navswitch.c ../../drivers/avr/delay.h ../../drivers/navswitch.h ../../drivers/avr/system.h ../../drivers/avr/pio.h
	$(CC) -c $(CFLAGS) $< -o $@

game.out: game.o task.o timer.o system.o game_display.o ledmat.o pio.o game_snake.o game_input.o navswitch.o
	$(CC) $(CFLAGS) $^ -o $@ -lm
	$(SIZE) $@



# Target: clean project.

.PHONY: clean

clean:

	-$(DEL) *.o *.out *.hex




# Target: program project.

.PHONY: program

program: game.out

	$(OBJCOPY) -O ihex game.out game.hex

	dfu-programmer atmega32u2 erase; dfu-programmer atmega32u2 flash game.hex; dfu-programmer atmega32u2 start


